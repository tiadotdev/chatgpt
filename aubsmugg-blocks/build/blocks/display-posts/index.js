!function(){"use strict";var e={n:function(t){var l=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(l,{a:l}),l},d:function(t,l){for(var a in l)e.o(l,a)&&!e.o(t,a)&&Object.defineProperty(t,a,{enumerable:!0,get:l[a]})},o:function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}},t=window.wp.blocks,l=window.wp.element,a=window.wp.i18n,o=window.wp.components,s=window.wp.blockEditor,n=window.wp.data,r=window.wp.serverSideRender,m=e.n(r),u=window.wp.apiFetch,c=e.n(u);(0,t.registerBlockType)("aubsmugg/display-posts",{edit:function({attributes:e,setAttributes:t}){const{postsPerPage:r,sort:u,categories:g,tags:i,postTypes:b,manualActive:d,manualPosts:p}=e,_=[{label:(0,a.__)("Newest to oldest","aubsmugg"),value:"date/desc"},{label:(0,a.__)("Oldest to newest","aubsmugg"),value:"date/asc"},{label:(0,a.__)("A → Z","aubsmugg"),value:"title/asc"},{label:(0,a.__)("Z → A","aubsmugg"),value:"title/desc"},{label:(0,a.__)("Random","aubsmugg"),value:"rand"}];d&&_.push({label:(0,a.__)("Manual","aubsmugg"),value:"post__in"});const h=(0,n.useSelect)((e=>{const t=e("core").getEntityRecords("taxonomy","category",{per_page:-1});return t?t.map((e=>({id:e.id,name:e.name}))):[]}),[]),y=(0,n.useSelect)((e=>{const t=e("core").getEntityRecords("taxonomy","post_tag",{per_page:-1});return t?t.map((e=>({id:e.id,name:e.name}))):[]}),[]),[f,w]=(0,l.useState)({}),[E,k]=(0,l.useState)([]);(0,l.useEffect)((()=>{c()({path:"/aubsmugg/v1/display-posts"}).then((e=>{w(e),k(e)})).catch((e=>{console.error(e)}))}),[]);const v=Object.keys(f),S=Object.values(E).flat(),C=(0,s.useBlockProps)();return(0,l.createElement)(l.Fragment,null,(0,l.createElement)(s.InspectorControls,null,(0,l.createElement)(o.PanelBody,{title:(0,a.__)("Display Posts Settings")},(0,l.createElement)("label",{className:"blocks-base-control__label",htmlFor:"sort",style:{fontSize:"0.875rem",marginBottom:"0.875rem",display:"block",fontWeight:"bold"}},(0,a.__)("Order","aubsmugg")),(0,l.createElement)(o.SelectControl,{label:(0,a.__)("Sort by","aubsmugg"),value:u,options:_,onChange:e=>{console.log("Changing sort to:",e),t({sort:e}),console.log("Sort is now:",u)}}),(0,l.createElement)("hr",null),(0,l.createElement)("label",{className:"blocks-base-control__label",htmlFor:"manualActive",style:{fontSize:"0.875rem",marginBottom:"0.875rem",display:"block",fontWeight:"bold"}},(0,a.__)("Selection Type","aubsmugg")),(0,l.createElement)(o.ToggleControl,{label:(0,a.__)("Manual Selection","aubsmugg"),checked:d,help:(0,a.__)("If checked, you can manually select posts to display.","aubsmugg"),onChange:()=>t({manualActive:!d})}),d?(0,l.createElement)(l.Fragment,null,(0,l.createElement)("hr",null),(0,l.createElement)("label",{className:"blocks-base-control__label",htmlFor:"manualPosts",style:{fontSize:"0.875rem",marginBottom:"0.875rem",display:"block",fontWeight:"bold"}},(0,a.__)("Choose Posts","aubsmugg")),(0,l.createElement)(o.FormTokenField,{label:(0,a.__)("Select Posts","aubsmugg"),value:p.map((e=>(S.find((t=>t.ID===e))||{}).post_title||"")).filter((e=>""!==e)),suggestions:S.map((e=>e.post_title)),onChange:e=>t({manualPosts:e.map((e=>(S.find((t=>t.post_title===e))||{}).ID||null)).filter((e=>null!==e))})})):(0,l.createElement)(l.Fragment,null,(0,l.createElement)("hr",null),(0,l.createElement)("label",{className:"blocks-base-control__label",htmlFor:"posts-per-page",style:{fontSize:"0.875rem",marginBottom:"0.875rem",display:"block",fontWeight:"bold"}},(0,a.__)("Posts Per Page","aubsmugg")),(0,l.createElement)(o.ToggleControl,{label:(0,a.__)("Show All Posts"),checked:-1===r,onChange:()=>t({postsPerPage:-1===r?12:-1})}),-1!==r&&(0,l.createElement)(o.RangeControl,{label:(0,a.__)("Number of Posts to Show","aubsmugg"),value:r,onChange:e=>{t({postsPerPage:e})},min:1,max:40}),(0,l.createElement)("hr",null),(0,l.createElement)("label",{className:"blocks-base-control__label",htmlFor:"post-types",style:{fontSize:"0.875rem",marginBottom:"0.875rem",display:"block",fontWeight:"bold"}},(0,a.__)("Post Types","aubsmugg")),(0,l.createElement)(o.FormTokenField,{label:(0,a.__)("Select Post Types","your-text-domain"),value:b,suggestions:v,onChange:e=>t({postTypes:e})}),(0,l.createElement)("hr",null),(0,l.createElement)("label",{className:"blocks-base-control__label",htmlFor:"Categories",style:{fontSize:"0.875rem",marginBottom:"0.875rem",display:"block",fontWeight:"bold"}},(0,a.__)("Categories","aubsmugg")),(0,l.createElement)(o.FormTokenField,{label:(0,a.__)("Select Categories","aubsmugg"),value:g.selected.map((e=>(h.find((t=>t.id===e))||{}).name||"")),suggestions:h.map((e=>e.name)),onChange:e=>t({categories:{...g,selected:e.map((e=>(h.find((t=>t.name===e))||{}).id||""))}})}),(0,l.createElement)(o.RadioControl,{label:(0,a.__)("Category Relationship","aubsmugg"),selected:g.relation,help:(0,a.__)("If you select 'AND', only posts that are in all selected categories will be displayed. If you select 'OR', posts that are in any of the selected categories will be displayed.","aubsmugg"),options:[{label:(0,a.__)("AND","aubsmugg"),value:"AND"},{label:(0,a.__)("OR","aubsmugg"),value:"OR"}],onChange:e=>t({categories:{...g,relation:e}})}),(0,l.createElement)("hr",null),(0,l.createElement)("label",{className:"blocks-base-control__label",htmlFor:"Tags",style:{fontSize:"0.875rem",marginBottom:"0.875rem",display:"block",fontWeight:"bold"}},(0,a.__)("Tags","aubsmugg")),(0,l.createElement)(o.FormTokenField,{label:(0,a.__)("Select Tags","aubsmugg"),value:i.selected.map((e=>(y.find((t=>t.id===e))||{}).name||"")),suggestions:y.map((e=>e.name)),onChange:e=>t({tags:{...i,selected:e.map((e=>(y.find((t=>t.name===e))||{}).id||""))}})}),(0,l.createElement)(o.RadioControl,{label:(0,a.__)("Tag Relationship","aubsmugg"),selected:i.relation,help:(0,a.__)("If you select 'AND', only posts that are in all selected tags will be displayed. If you select 'OR', posts that are in any of the selected tags will be displayed.","aubsmugg"),options:[{label:(0,a.__)("AND","aubsmugg"),value:"AND"},{label:(0,a.__)("OR","aubsmugg"),value:"OR"}],onChange:e=>t({tags:{...i,relation:e}})})))),(0,l.createElement)("div",{...C},(0,l.createElement)(m(),{block:"aubsmugg/display-posts",attributes:e})))},save:()=>null})}();